"use strict";(self.webpackChunkpersonalized_news_frontend=self.webpackChunkpersonalized_news_frontend||[]).push([[160],{2171:()=>{},8160:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var a=r(9950),s=r(2074),l=r(6910),i=r(9348),n=(r(2171),r(4414));function c(){const[e,t]=(0,a.useState)([]),[r,c]=(0,a.useState)([]),[o,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{m()},[]);const m=async()=>{try{const e=localStorage.getItem("token"),r=await l.A.get("".concat("http://localhost:5000","/api/user/profile"),{headers:{"x-auth-token":e}});t(r.data.readingHistory||[]);const a=await l.A.get("".concat("http://localhost:5000","/api/user/external-history"),{headers:{"x-auth-token":e}});c(a.data||[]),d(!1)}catch(e){i.oR.error("Failed to fetch reading history"),d(!1)}};return o?(0,n.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):(0,n.jsx)("div",{className:"modern-bg min-h-screen py-8",children:(0,n.jsx)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl p-10 border border-gray-100",children:[(0,n.jsx)("h1",{className:"text-3xl font-extrabold text-primary-700 mb-8 tracking-tight drop-shadow",children:"Reading History"}),0===e.length&&0===r.length?(0,n.jsx)("p",{className:"text-gray-500",children:"No reading history yet."}):(0,n.jsxs)(n.Fragment,{children:[e.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-primary-700 mb-4",children:"Local Articles"}),(0,n.jsx)("ul",{className:"divide-y divide-gray-200 mb-8",children:e.slice().reverse().map((e,r)=>{var a;return(0,n.jsxs)("li",{className:"py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(s.N_,{to:"/article/".concat(e.articleId),className:"text-primary-600 hover:underline font-medium",children:(null===(a=e.articleId)||void 0===a?void 0:a.title)||e.articleId}),(0,n.jsx)("span",{className:"ml-2 text-gray-500 text-sm",children:e.readAt?new Date(e.readAt).toLocaleString():""}),(0,n.jsx)("button",{onClick:()=>(async e=>{try{const r=localStorage.getItem("token");await l.A.delete("".concat("http://localhost:5000","/api/user/history/").concat(e),{headers:{"x-auth-token":r}}),t(t=>t.filter(t=>(t.articleId._id||t.articleId)!==e)),i.oR.success("History entry removed")}catch(r){i.oR.error("Failed to remove history entry")}})(e.articleId._id||e.articleId),className:"ml-4 text-xs text-red-600 hover:underline font-semibold",children:"Delete"})]}),e.timeSpent&&(0,n.jsxs)("span",{className:"text-xs text-gray-400",children:[e.timeSpent," min"]})]},r)})})]}),r.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-primary-700 mb-4",children:"NewsAPI Articles"}),(0,n.jsx)("ul",{className:"divide-y divide-gray-200",children:r.slice().reverse().map((e,t)=>(0,n.jsx)("li",{className:"py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[e.imageUrl&&(0,n.jsx)("img",{src:e.imageUrl,alt:"thumb",className:"h-10 w-16 object-cover rounded"}),(0,n.jsx)(s.N_,{to:"/external-article",state:{article:{url:e.url,title:e.title,urlToImage:e.imageUrl,source:{name:e.source}}},className:"text-primary-600 hover:underline font-medium",children:e.title}),(0,n.jsx)("span",{className:"ml-2 text-gray-500 text-sm",children:e.readAt?new Date(e.readAt).toLocaleString():""}),(0,n.jsx)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token");await l.A.delete("".concat("http://localhost:5000","/api/user/external-history"),{data:{url:e},headers:{"x-auth-token":t}}),c(t=>t.filter(t=>t.url!==e)),i.oR.success("History entry removed")}catch(t){i.oR.error("Failed to remove history entry")}})(e.url),className:"ml-4 text-xs text-red-600 hover:underline font-semibold",children:"Delete"})]})},e.url))})]})]})]})})})}}}]);