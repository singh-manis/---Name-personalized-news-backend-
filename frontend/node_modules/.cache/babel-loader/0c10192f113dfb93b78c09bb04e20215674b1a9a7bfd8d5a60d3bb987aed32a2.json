{"ast":null,"code":"import _objectSpread from\"C:/Users/Manish singh/Desktop/personalized-news/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useCallback,useMemo}from'react';import{Link,useNavigate}from'react-router-dom';import axios from'axios';import{toast}from'react-toastify';import{BookmarkIcon,ChatBubbleLeftIcon,HeartIcon,ChatBubbleOvalLeftEllipsisIcon,FireIcon,XMarkIcon,ShareIcon}from'@heroicons/react/24/outline';import{io}from'socket.io-client';import DatePicker from'react-datepicker';import'react-datepicker/dist/react-datepicker.css';import{useTranslation}from'react-i18next';import ReactMarkdown from'react-markdown';import'./HomeModern.css';import ArticleCard from'../components/ArticleCard';import AIAssistantPanel from'../components/AIAssistantPanel';import TrendingPanel from'../components/TrendingPanel';import{useArticles}from'../hooks/useArticles';import{useTrending}from'../hooks/useTrending';import{ArticleCardSkeleton,SearchFormSkeleton,LoadingSpinner}from'../components/LoadingSkeleton';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Home(){var _selectedTrending$sou,_selectedTrending$sou2;const{articles,nextPage,loading,loadingMore,fetchArticles,loadMoreArticles,setArticles,setNextPage}=useArticles();const[selectedArticle,setSelectedArticle]=useState(null);const[question,setQuestion]=useState('');const[answer,setAnswer]=useState('');const[aiLoading,setAiLoading]=useState(false);const[dailyBriefing,setDailyBriefing]=useState('');const[briefingLoading,setBriefingLoading]=useState(true);// Search state\nconst[query,setQuery]=useState('');const[searchResults,setSearchResults]=useState(null);const[searchSummary,setSearchSummary]=useState('');const[searching,setSearching]=useState(false);const[notifications,setNotifications]=useState([]);const[userId,setUserId]=useState(null);const[category,setCategory]=useState('');const[mediaType,setMediaType]=useState('');const[startDate,setStartDate]=useState(null);const[endDate,setEndDate]=useState(null);const{t}=useTranslation();const[externalLikes,setExternalLikes]=useState([]);// NewsAPI liked URLs\nconst[userProfile,setUserProfile]=useState(null);const navigate=useNavigate();const[trendingPanelOpen,setTrendingPanelOpen]=useState(false);const[selectedTrending,setSelectedTrending]=useState(null);const[showAllTrending,setShowAllTrending]=useState(false);const observer=useRef();const lastArticleRef=useCallback(node=>{if(loadingMore)return;if(observer.current)observer.current.disconnect();observer.current=new window.IntersectionObserver(entries=>{if(entries[0].isIntersecting&&nextPage){loadMoreArticles();}});if(node)observer.current.observe(node);},[loadingMore,nextPage]);const{trending,loadingTrending,fetchTrending,setTrending}=useTrending();useEffect(()=>{fetchArticles();// Fetch external likes and user profile\nconst fetchProfile=async()=>{try{const token=localStorage.getItem('token');const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/user/profile\"),{headers:{'x-auth-token':token}});setExternalLikes(res.data.externalLikes||[]);setUserProfile(res.data);}catch(err){// ignore\n}};fetchProfile();},[]);useEffect(()=>{const socket=io('http://localhost:5000');// or your backend URL\nsocket.on('new-article',article=>{setArticles(prev=>[article,...prev]);});return()=>{socket.disconnect();};},[]);useEffect(()=>{const fetchNotifications=async()=>{const token=localStorage.getItem('token');const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/user/notifications\"),{headers:{'x-auth-token':token}});setNotifications(res.data);};fetchNotifications();},[]);useEffect(()=>{// Get user ID from token (assumes JWT with sub or id field)\nconst token=localStorage.getItem('token');if(token){try{const payload=JSON.parse(atob(token.split('.')[1]));setUserId(payload.id||payload.sub||null);}catch(e){setUserId(null);}}},[]);useEffect(()=>{// Fetch trending articles\nconst fetchTrending=async()=>{try{const token=localStorage.getItem('token');const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/trending\"),{headers:{'x-auth-token':token}});setTrending(res.data);}catch(err){// Optionally toast error\n}};fetchTrending();fetchDailyBriefing();},[]);const fetchDailyBriefing=async()=>{setBriefingLoading(true);try{const token=localStorage.getItem('token');const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/ai/daily-briefing\"),{headers:{'x-auth-token':token}});setDailyBriefing(res.data.briefing);}catch(err){setDailyBriefing('Failed to load the daily briefing. Please try again later.');}finally{setBriefingLoading(false);}};const handleSaveArticle=async article=>{try{const token=localStorage.getItem('token');if(article._id){await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/article/\").concat(article._id,\"/save\"),{},{headers:{'x-auth-token':token}});toast.success('Article saved successfully');}else{// NewsAPI/newsdata.io article\nconst url=article.url||article.link;console.log('Sending bookmark for external article with url:',url);if(!url||typeof url!=='string'||!url.startsWith('http')){toast.error('No valid URL for this article.');return;}await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/external/bookmark\"),{url},{headers:{'x-auth-token':token}});toast.success('Bookmarked!');}}catch(err){toast.error('Failed to save article');}};const handleAskQuestion=async e=>{e.preventDefault();if(!question.trim())return;setAiLoading(true);try{const token=localStorage.getItem('token');const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/ai/qa\"),{question,context:selectedArticle.content},{headers:{'x-auth-token':token}});setAnswer(res.data.answer);}catch(err){toast.error('Failed to get answer');}finally{setAiLoading(false);}};const handleSearch=async e=>{e.preventDefault();if(!query.trim())return;setSearching(true);try{const token=localStorage.getItem('token');const params=new URLSearchParams({q:query});if(category)params.append('category',category);if(mediaType)params.append('mediaType',mediaType);if(startDate)params.append('startDate',startDate.toISOString());if(endDate)params.append('endDate',endDate.toISOString());const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/search?\").concat(params.toString()),{headers:{'x-auth-token':token}});setSearchResults(res.data.articles);setSearchSummary(res.data.summary);}catch(err){toast.error('Failed to search');}finally{setSearching(false);}};const handleBackToFeed=()=>{setSearchResults(null);setSearchSummary('');setQuery('');};const handleLikeArticle=async article=>{try{const token=localStorage.getItem('token');if(article._id){const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/article/\").concat(article._id,\"/like\"),{},{headers:{'x-auth-token':token}});setArticles(prev=>prev.map(a=>a._id===article._id?_objectSpread(_objectSpread({},a),{},{likes:res.data.likes}):a));if(searchResults){setSearchResults(prev=>prev.map(a=>a._id===article._id?_objectSpread(_objectSpread({},a),{},{likes:res.data.likes}):a));}}else{// NewsAPI/newsdata.io article\nconst url=article.url||article.link;console.log('Sending like for external article with url:',url);if(!url||typeof url!=='string'||!url.startsWith('http')){toast.error('No valid URL for this article.');return;}if(externalLikes.includes(url)){await axios.delete(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/external/like\"),{data:{url},headers:{'x-auth-token':token}});setExternalLikes(prev=>prev.filter(u=>u!==url));}else{await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/external/like\"),{url},{headers:{'x-auth-token':token}});setExternalLikes(prev=>[...prev,url]);}}}catch(err){toast.error('Failed to like article');}};// Helper for greeting\nfunction getGreeting(){const hour=new Date().getHours();if(hour<12)return'Good morning';if(hour<18)return'Good afternoon';return'Good evening';}// Helper for sharing (copy link)\nconst handleShare=url=>{if(navigator.clipboard&&url){navigator.clipboard.writeText(url);toast.success('Link copied!');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"modern-bg min-h-screen py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-xl font-bold text-white\",children:\"M\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-base font-medium text-gray-400 dark:text-gray-300\",children:[\"Good morning, \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-primary-600 dark:text-primary-300\",children:\"Manish kumar!\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/60 backdrop-blur-md border border-white/40 shadow-lg rounded-xl dark:bg-slate-800 dark:backdrop-blur-none dark:border-slate-700 dark:shadow dark:rounded-lg p-10 mb-10\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-extrabold text-primary-700 dark:text-primary-200 mb-8 tracking-tight drop-shadow\",children:t('Your Personalized News Feed')}),/*#__PURE__*/_jsx(SearchFormSkeleton,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-primary-700 mb-6 tracking-tight drop-shadow\",children:t('Your Personalized Feed')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-8\",children:[1,2,3].map(i=>/*#__PURE__*/_jsx(ArticleCardSkeleton,{},i))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-24\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/60 backdrop-blur-md border border-white/40 shadow-lg rounded-xl dark:bg-slate-800 dark:backdrop-blur-none dark:border-slate-700 dark:shadow dark:rounded-lg p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-6 w-32 bg-gray-200 dark:bg-gray-700 rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-5 w-5 bg-gray-200 dark:bg-gray-700 rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 dark:bg-gray-700 rounded\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/6\"})]})]})})})]})]})]})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"modern-bg min-h-screen py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-xl font-bold text-white\",children:\"M\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-base font-medium text-gray-400 dark:text-gray-300\",children:[\"Good morning, \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-primary-600 dark:text-primary-300\",children:\"Manish kumar!\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/60 backdrop-blur-md border border-white/40 shadow-lg rounded-xl dark:bg-slate-800 dark:backdrop-blur-none dark:border-slate-700 dark:shadow dark:rounded-lg p-10 mb-10\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-extrabold text-primary-700 dark:text-primary-200 mb-8 tracking-tight drop-shadow\",children:t('Your Personalized News Feed')}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"mb-6 flex flex-col md:flex-row md:items-end gap-3 w-full\",children:[/*#__PURE__*/_jsx(\"input\",{value:query,onChange:e=>setQuery(e.target.value),placeholder:t('Search news...'),className:\"h-10 rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1 dark:bg-gray-800 dark:text-white\"}),/*#__PURE__*/_jsxs(\"select\",{value:category,onChange:e=>setCategory(e.target.value),className:\"h-10 rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1 dark:bg-gray-800 dark:text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:t('All Categories')}),/*#__PURE__*/_jsx(\"option\",{value:\"technology\",children:t('Technology')}),/*#__PURE__*/_jsx(\"option\",{value:\"science\",children:t('Science')}),/*#__PURE__*/_jsx(\"option\",{value:\"business\",children:t('Business')}),/*#__PURE__*/_jsx(\"option\",{value:\"health\",children:t('Health')}),/*#__PURE__*/_jsx(\"option\",{value:\"entertainment\",children:t('Entertainment')}),/*#__PURE__*/_jsx(\"option\",{value:\"sports\",children:t('Sports')}),/*#__PURE__*/_jsx(\"option\",{value:\"politics\",children:t('Politics')}),/*#__PURE__*/_jsx(\"option\",{value:\"education\",children:t('Education')})]}),/*#__PURE__*/_jsxs(\"select\",{value:mediaType,onChange:e=>setMediaType(e.target.value),className:\"h-10 rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1 dark:bg-gray-800 dark:text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:t('All Media')}),/*#__PURE__*/_jsx(\"option\",{value:\"text\",children:t('Text')}),/*#__PURE__*/_jsx(\"option\",{value:\"image\",children:t('Image')}),/*#__PURE__*/_jsx(\"option\",{value:\"video\",children:t('Video')}),/*#__PURE__*/_jsx(\"option\",{value:\"podcast\",children:t('Podcast')})]}),/*#__PURE__*/_jsx(DatePicker,{selected:startDate,onChange:date=>setStartDate(date),selectsStart:true,startDate:startDate,endDate:endDate,placeholderText:t('Start Date'),className:\"h-10 rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1 text-sm dark:bg-gray-800 dark:text-white\",dateFormat:\"yyyy-MM-dd\",isClearable:true}),/*#__PURE__*/_jsx(DatePicker,{selected:endDate,onChange:date=>setEndDate(date),selectsEnd:true,startDate:startDate,endDate:endDate,minDate:startDate,placeholderText:t('End Date'),className:\"h-10 rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1 text-sm dark:bg-gray-800 dark:text-white\",dateFormat:\"yyyy-MM-dd\",isClearable:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"h-10 px-6 rounded-md bg-primary-600 text-white font-medium hover:bg-primary-700 dark:bg-primary-700 dark:hover:bg-primary-800 whitespace-nowrap flex-shrink-0\",disabled:searching,children:searching?t('Searching...'):t('Search')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-primary-700 dark:text-primary-200 flex items-center\",children:[/*#__PURE__*/_jsx(FireIcon,{className:\"h-6 w-6 mr-2 text-orange-500\"}),\" \",t('Trending')]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-primary-600 dark:text-primary-300 font-semibold hover:underline text-sm px-3 py-1 rounded focus:outline-none\",onClick:()=>{setShowAllTrending(true);setTrendingPanelOpen(true);},children:t('See All Trending')})]}),trending.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 dark:text-gray-400\",children:t('No trending topics right now.')}):/*#__PURE__*/_jsx(TrendingPanel,{trending:trending,t:t,showAllTrending:showAllTrending,setShowAllTrending:setShowAllTrending})]}),trendingPanelOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 flex justify-end bg-black bg-opacity-30\",onClick:()=>setTrendingPanelOpen(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-md h-full bg-white shadow-2xl p-6 overflow-y-auto relative animate-slide-in-right\",onClick:e=>e.stopPropagation(),tabIndex:-1,\"aria-modal\":\"true\",role:\"dialog\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"absolute top-4 right-4 text-gray-400 hover:text-primary-600 focus:outline-none\",onClick:()=>setTrendingPanelOpen(false),\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(XMarkIcon,{className:\"h-7 w-7\"})}),showAllTrending?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-primary-700 mb-6\",children:t('All Trending Articles')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:trending.map((article,idx)=>{var _article$source,_article$source2;return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl shadow-md border border-blue-100 p-4 mb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[(()=>{const imgSrc=article.image_url||article.imageUrl||article.urlToImage;return imgSrc?/*#__PURE__*/_jsx(\"img\",{src:imgSrc,alt:article.title,className:\"w-24 h-24 object-cover rounded-lg\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 flex items-center justify-center text-4xl text-gray-300 bg-gray-100 rounded-lg\",children:\"\\uD83D\\uDCF0\"});})(),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow mb-2\",children:article.category||((_article$source=article.source)===null||_article$source===void 0?void 0:_article$source.name)||'Trending'}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-900 mb-1\",children:article.title}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400 mb-1\",children:article.publishedAt?new Date(article.publishedAt).toLocaleDateString():''}),((_article$source2=article.source)===null||_article$source2===void 0?void 0:_article$source2.name)&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-blue-700 font-semibold mb-1\",children:article.source.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-auto\",children:[/*#__PURE__*/_jsx(\"a\",{href:article.url||article.link,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-xs text-primary-600 hover:underline font-semibold\",children:\"Read\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleShare(article.url||article.link),className:\"text-xs text-gray-500 hover:text-primary-600 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(ShareIcon,{className:\"h-4 w-4\"}),\"Share\"]})]})]})]})},article._id||article.url||article.link||idx);})})]}):selectedTrending&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center mb-6\",children:[(()=>{const imgSrc=selectedTrending.image_url||selectedTrending.imageUrl||selectedTrending.urlToImage;return imgSrc?/*#__PURE__*/_jsx(\"img\",{src:imgSrc,alt:selectedTrending.title,className:\"w-full h-48 object-cover rounded-xl mb-4\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-48 flex items-center justify-center text-6xl text-gray-300 mb-4\",children:\"\\uD83D\\uDCF0\"});})(),/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-3 py-0.5 rounded-full text-xs font-semibold bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow mb-2\",children:selectedTrending.category||((_selectedTrending$sou=selectedTrending.source)===null||_selectedTrending$sou===void 0?void 0:_selectedTrending$sou.name)||'Trending'}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2 text-center\",children:selectedTrending.title}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400 mb-1\",children:selectedTrending.publishedAt?new Date(selectedTrending.publishedAt).toLocaleDateString():''}),((_selectedTrending$sou2=selectedTrending.source)===null||_selectedTrending$sou2===void 0?void 0:_selectedTrending$sou2.name)&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-blue-700 font-semibold mb-1\",children:selectedTrending.source.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"a\",{href:selectedTrending.url||selectedTrending.link,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-xs text-primary-600 hover:underline font-semibold\",children:\"Read\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleShare(selectedTrending.url||selectedTrending.link),className:\"text-xs text-gray-500 hover:text-primary-600 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(ShareIcon,{className:\"h-4 w-4\"}),\"Share\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700 text-base mb-4 whitespace-pre-line\",children:selectedTrending.description||selectedTrending.summary||''})]})]})}),searchResults?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/60 backdrop-blur-md border border-white/40 shadow-lg rounded-xl dark:bg-slate-800 dark:backdrop-blur-none dark:border-slate-700 dark:shadow dark:rounded-lg p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 dark:text-gray-100\",children:\"Search Results\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleBackToFeed,className:\"text-sm font-semibold text-primary-600 dark:text-primary-400 hover:underline\",children:\"Back to Feed\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300 mb-4\",children:searchSummary}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:searchResults.map((article,index)=>/*#__PURE__*/_jsx(ArticleCard,{article:article,onSave:handleSaveArticle,onLike:handleLikeArticle,isLiked:externalLikes.includes(article.link)},article.article_id||article._id||index))})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-extrabold text-primary-700 mb-6 tracking-tight drop-shadow\",children:t('Your Personalized Feed')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-8\",children:articles.map((article,idx)=>{var _article$source3,_article$source4;const isLast=idx===articles.length-1;return/*#__PURE__*/_jsx(\"div\",{ref:isLast?lastArticleRef:undefined,className:\"relative group bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl border border-blue-100 dark:border-gray-800 overflow-hidden transition-transform duration-300 hover:-translate-y-1 hover:shadow-3xl hover:border-blue-400\",style:{borderLeft:\"8px solid #6366f1\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 w-full md:w-56 h-48 md:h-auto bg-gradient-to-br from-blue-100 to-purple-100 flex items-center justify-center\",children:(()=>{const imgSrc=article.image_url||article.imageUrl||article.urlToImage;return imgSrc?/*#__PURE__*/_jsx(\"img\",{src:imgSrc,alt:article.title,className:\"w-full h-full object-cover rounded-t-3xl md:rounded-l-3xl md:rounded-t-none\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center text-5xl text-gray-300\",children:/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"news\",children:\"\\uD83D\\uDCF0\"})});})()}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 p-6 flex flex-col justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow\",children:article.category||((_article$source3=article.source)===null||_article$source3===void 0?void 0:_article$source3.name)||'General'}),article.videoUrl&&/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-pink-100 text-pink-700\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"h-4 w-4 mr-1\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 6v12a2 2 0 002 2h8a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2z\"})}),\"Video\"]}),article.podcastUrl&&/*#__PURE__*/_jsxs(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"h-4 w-4 mr-1\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"3\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19.4 15A7.963 7.963 0 0020 12c0-4.418-3.582-8-8-8S4 7.582 4 12c0 1.042.2 2.04.56 2.95\"})]}),\"Podcast\"]})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-extrabold text-gray-900 dark:text-white mb-2 group-hover:text-primary-700 transition-colors duration-200\",children:article._id?/*#__PURE__*/_jsx(Link,{to:\"/article/\".concat(article._id),children:article.title}):/*#__PURE__*/_jsx(Link,{to:\"/external-article\",state:{article},children:article.title})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 dark:text-gray-300 mb-4 text-lg leading-relaxed line-clamp-3\",children:article.summary||article.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 text-xs text-gray-500\",children:[((_article$source4=article.source)===null||_article$source4===void 0?void 0:_article$source4.name)&&/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-blue-700 dark:text-blue-300\",children:article.source.name}),/*#__PURE__*/_jsx(\"span\",{children:article.publishedAt?new Date(article.publishedAt).toLocaleDateString():''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"a\",{href:article.url||article.link||\"/article/\".concat(article._id),target:\"_blank\",rel:\"noopener noreferrer\",className:\"px-3 py-1 rounded-full bg-primary-600 text-white text-xs font-semibold shadow hover:bg-primary-700 dark:bg-primary-700 dark:hover:bg-primary-800 transition\",children:\"Read\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleLikeArticle(article),className:\"text-sm flex items-center gap-1 \".concat(article._id?userId&&article.likes&&article.likes.includes(userId)?'text-red-500':'text-gray-400':externalLikes.includes(article.url)?'text-red-500':'text-gray-400',\" hover:text-red-600\"),title:article._id?userId&&article.likes&&article.likes.includes(userId)?'Unlike':'Like':externalLikes.includes(article.url)?'Unlike':'Like',children:[/*#__PURE__*/_jsx(HeartIcon,{className:\"h-5 w-5\"}),article._id?article.likes?article.likes.length:0:'']}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSaveArticle(article),className:\"text-gray-400 hover:text-primary-600\",children:/*#__PURE__*/_jsx(BookmarkIcon,{className:\"h-6 w-6\"})})]})]})]})]})},article._id||article.url||article.link||idx);})}),loadingMore&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center py-8\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"lg\"})}),!loadingMore&&nextPage===null&&articles.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center py-8 fade-in\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-blue-100 to-purple-100 text-primary-700 rounded-full px-6 py-2 shadow font-semibold text-lg border border-blue-200\",children:[\"\\uD83C\\uDF89 \",t('You have reached the end of your feed!')]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-24\",children:/*#__PURE__*/_jsx(AIAssistantPanel,{briefingLoading:briefingLoading,dailyBriefing:dailyBriefing,fetchDailyBriefing:fetchDailyBriefing,t:t})})})]})]})]})})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}