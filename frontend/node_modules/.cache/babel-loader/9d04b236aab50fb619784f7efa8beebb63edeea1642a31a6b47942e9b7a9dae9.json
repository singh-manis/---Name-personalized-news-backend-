{"ast":null,"code":"import _objectSpread from\"C:/Users/Manish singh/Desktop/personalized-news/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate,useParams}from'react-router-dom';import axios from'axios';import{toast}from'react-toastify';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const categories=['technology','science','business','health','entertainment','sports','politics','education'];export default function AdminArticleForm(){const navigate=useNavigate();const{id}=useParams();const isEdit=Boolean(id);const[loading,setLoading]=useState(false);const[notFound,setNotFound]=useState(false);const[form,setForm]=useState({title:'',content:'',summary:'',category:'',imageUrl:'',videoUrl:'',podcastUrl:'',tags:''});useEffect(()=>{if(isEdit){fetchArticle();}// eslint-disable-next-line\n},[id]);const fetchArticle=async()=>{setLoading(true);try{const token=localStorage.getItem('token');const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/article/\").concat(id),{headers:{'x-auth-token':token}});setForm({title:res.data.title||'',content:res.data.content||'',summary:res.data.summary||'',category:res.data.category||'',imageUrl:res.data.imageUrl||'',videoUrl:res.data.videoUrl||'',podcastUrl:res.data.podcastUrl||'',tags:(res.data.tags||[]).join(', ')});setNotFound(false);setLoading(false);}catch(err){if(err.response&&err.response.status===404){setNotFound(true);}else{toast.error('Failed to fetch article');}setLoading(false);}};const handleChange=e=>{setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();setLoading(true);try{const token=localStorage.getItem('token');const payload=_objectSpread(_objectSpread({},form),{},{tags:form.tags.split(',').map(t=>t.trim()).filter(Boolean)});if(isEdit){await axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/article/\").concat(id),payload,{headers:{'x-auth-token':token}});toast.success('Article updated');}else{await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/news/article\"),payload,{headers:{'x-auth-token':token}});toast.success('Article created');}navigate('/admin');}catch(err){toast.error('Failed to save article');}finally{setLoading(false);}};if(notFound){return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-6\",children:\"Article Not Found\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/admin'),className:\"bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700\",children:\"Back to Admin\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-6\",children:isEdit?'Edit Article':'Add New Article'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-6 bg-white rounded-lg shadow-md p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",value:form.title,onChange:handleChange,required:true,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Summary\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"summary\",value:form.summary,onChange:handleChange,required:true,rows:2,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Content\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"content\",value:form.content,onChange:handleChange,required:true,rows:6,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Category\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"category\",value:form.category,onChange:handleChange,required:true,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select category\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat,children:cat.charAt(0).toUpperCase()+cat.slice(1)},cat))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Image URL\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"imageUrl\",value:form.imageUrl,onChange:handleChange,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Video URL\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"videoUrl\",value:form.videoUrl,onChange:handleChange,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Podcast URL\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"podcastUrl\",value:form.podcastUrl,onChange:handleChange,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Tags (comma separated)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"tags\",value:form.tags,onChange:handleChange,className:\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"bg-primary-600 text-white px-4 py-2 rounded hover:bg-primary-700\",children:loading?'Saving...':isEdit?'Update Article':'Create Article'})})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}