{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{toast}from'react-toastify';import{Bar,Pie}from'react-chartjs-2';import{Chart as ChartJS,CategoryScale,LinearScale,BarElement,Title,Tooltip,Legend,ArcElement}from'chart.js';import{useTranslation}from'react-i18next';import'./HomeModern.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,BarElement,Title,Tooltip,Legend,ArcElement);export default function Analytics(){var _analytics$topicPrefe,_analytics$topicPrefe2,_analytics$insights;const[analytics,setAnalytics]=useState(null);const[loading,setLoading]=useState(true);const{t}=useTranslation();useEffect(()=>{fetchAnalytics();},[]);const fetchAnalytics=async()=>{try{const token=localStorage.getItem('token');const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/user/analytics\"),{headers:{'x-auth-token':token}});setAnalytics(res.data);setLoading(false);}catch(err){toast.error('Failed to fetch analytics');setLoading(false);}};// Prepare chart data\nconst topicLabels=(analytics===null||analytics===void 0?void 0:analytics.topicsCovered)||[];const topicCounts=(analytics===null||analytics===void 0?void 0:(_analytics$topicPrefe=analytics.topicPreferences)===null||_analytics$topicPrefe===void 0?void 0:_analytics$topicPrefe.map(t=>t.count))||[];const topicNames=(analytics===null||analytics===void 0?void 0:(_analytics$topicPrefe2=analytics.topicPreferences)===null||_analytics$topicPrefe2===void 0?void 0:_analytics$topicPrefe2.map(t=>t.name))||[];const barData={labels:topicNames,datasets:[{label:t('Articles Read'),data:topicCounts,backgroundColor:'rgba(59,130,246,0.7)'}]};const pieData={labels:topicNames,datasets:[{label:t('Articles by Topic'),data:topicCounts,backgroundColor:['#fbbf24','#60a5fa','#34d399','#f87171','#a78bfa','#f472b6','#facc15','#38bdf8']}]};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600\"})});}return/*#__PURE__*/_jsx(\"div\",{className:\"modern-bg min-h-screen py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-extrabold text-primary-700 mb-10 tracking-tight drop-shadow\",children:t('Reading Analytics')}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl p-8 flex flex-col items-center border border-gray-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-primary-700 mb-6\",children:t('Reading Statistics')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-6 w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-block h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-2xl font-bold text-blue-600 shadow\",children:(analytics===null||analytics===void 0?void 0:analytics.totalArticlesRead)||0}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:t('Total Articles Read')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-block h-10 w-10 rounded-full bg-green-100 flex items-center justify-center text-2xl font-bold text-green-600 shadow\",children:(analytics===null||analytics===void 0?void 0:analytics.totalTimeSpent)||0}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:t('Total Time Spent')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400\",children:t('min')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-block h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center text-2xl font-bold text-purple-600 shadow\",children:(analytics===null||analytics===void 0?void 0:analytics.savedArticles)||0}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:t('Articles Saved')})})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl p-8 flex flex-col border border-gray-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-primary-700 mb-6\",children:t('Topic Preferences')}),topicNames.length>0?/*#__PURE__*/_jsx(Bar,{data:barData,options:{responsive:true,plugins:{legend:{display:false},title:{display:false}},scales:{y:{beginAtZero:true}}}}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:t('No topic data yet.')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-xl p-8 flex flex-col border border-gray-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-primary-700 mb-6\",children:t('Topic Distribution')}),topicNames.length>0?/*#__PURE__*/_jsx(Pie,{data:pieData,options:{responsive:true,plugins:{legend:{position:'bottom'},title:{display:false}}}}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:t('No topic data yet.')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-10 bg-white rounded-2xl shadow-xl p-8 border border-gray-100\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-primary-700 mb-6\",children:t('Reading Insights')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:analytics===null||analytics===void 0?void 0:(_analytics$insights=analytics.insights)===null||_analytics$insights===void 0?void 0:_analytics$insights.map((insight,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-primary-600 text-sm font-medium\",children:index+1})})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-900\",children:insight})})]},index))})]})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}